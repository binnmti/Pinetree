<footer class="footer @GetFooterClass()">
    <div class="container">
        <div class="d-flex flex-column align-items-center">
            <div class="footer-links my-1">
                <a href="/changelog" class="mx-2">Changelog</a>
                <a href="/terms" class="mx-2">Terms</a>
                <a href="/privacy" class="mx-2">Privacy</a>
            </div>
            <div class="footer-copyright my-1 text-center">
                <span>Â© 2025 Pinetree</span>
                <span class="version ms-2">Version @AppVersion</span>
            </div>
        </div>
    </div>
</footer>

<style>
    .footer {
        width: 100%;
        background-color: #f5f5f5;
        padding: 10px 0;
        border-top: 1px solid #ddd;
        margin-top: 20px;
    }

    .footer-fixed {
        position: fixed;
        bottom: 0;
        left: 0;
        z-index: 1000;
    }

    .footer-hidden {
        display: none;
    }

    .footer-links {
        font-size: 0.9rem;
    }

    .footer-copyright {
        font-size: 0.85rem;
        color: #666;
    }

    .version {
        color: #888;
    }
</style>

@code {
    [Inject]
    private IConfiguration Configuration { get; set; } = default!;

    [Inject]
    private NavigationManager NavigationManager { get; set; } = default!;

    private string AppVersion => Configuration["AppVersion"] ?? "1.0.0";

    private string GetFooterClass()
    {
        var path = NavigationManager.ToBaseRelativePath(NavigationManager.Uri).ToLowerInvariant();

        if (path.StartsWith("play") ||
            path.StartsWith("edit/") ||
            path.StartsWith("view/"))
        {
            return "footer-hidden";
        }

        if (path.StartsWith("terms") ||
            path.StartsWith("privacy") ||
            path.StartsWith("changelog") ||
            path.StartsWith("user") ||
            path.StartsWith("home"))
        {
            return "";
        }

        return "footer-fixed";
    }

    protected override void OnInitialized()
    {
        NavigationManager.LocationChanged += (sender, e) => StateHasChanged();
    }

    public void Dispose()
    {
        NavigationManager.LocationChanged -= (sender, e) => StateHasChanged();
    }
}