@page "/"
@using Pinetree.Client.Services
@inject IJSRuntime JSRuntime
@rendermode InteractiveAuto
@implements IAsyncDisposable

<PageTitle>Pinetree(Beta)</PageTitle>
<HeadContent>
    <meta property="og:title" content=@Title />
    <meta name="twitter:title" content=@Title />
    <meta name="description" content=@Description />
    <meta property="og:description" content=@Description />
    <meta name="twitter:description" content=@Description />
    <meta property="og:url" content=@Url />
    <link rel="canonical" href=@Url />
</HeadContent>

<div class="position-relative">
    <!-- Main Content - Centered -->
    <div style="display: flex; justify-content: center; align-items: center; text-align: center; flex-direction: column;">

        <h1 style="font-size: 4em; margin-top: 50px;">
            <img src="img/Pinetree64.webp" alt="Pinetree logo" width="64" height="64">
            Pinetree is browser-based <span class="highlight-text">hierarchical</span> markdown editor
        </h1>
        <div class="mt-4 button-container">
            <a class="btn btn-outline-primary btn-lg m-2" href="/play"><i class="bi bi-tools"></i>Playground</a>
            <a class="btn btn-outline-success btn-lg m-2" href="Account/Register"><i class="bi bi-person"></i>Register</a>
        </div>
        <div class="slider-container mt-4">
            <div class="slider" id="imageSlider">
                <div class="slide active">
                    <img src="img/PinetreeScreen.webp" alt="Pinetree Screenshot 1" class="main-image" width="1200" height="750" />
                </div>
                <div class="slide">
                    <img src="img/PinetreeScreen2.webp" alt="Pinetree Screenshot 2" class="main-image" width="1200" height="750" />
                </div>
                <div class="slide">
                    <img src="img/PinetreeScreen3.webp" alt="Pinetree Screenshot 3" class="main-image" width="1200" height="750" />
                </div>
            </div>
            <div class="slider-controls">
                <button class="slider-arrow prev" @onclick="PrevSlide">❮</button>
                <div class="slider-dots">
                    <span class="dot active" @onclick="() => SetSlide(0)"></span>
                    <span class="dot" @onclick="() => SetSlide(1)"></span>
                    <span class="dot" @onclick="() => SetSlide(2)"></span>
                </div>
                <button class="slider-arrow next" @onclick="NextSlide">❯</button>
            </div>
        </div>

        <!-- Hierarchical emphasis section -->
        <div class="hierarchical-emphasis my-5 py-4">
            <h2 class="mb-4">What is a <span class="highlight-text">Hierarchical</span> Markdown Editor?</h2>

            <div class="concept-box">
                <div class="concept-icon">
                    <i class="bi bi-file-earmark-text"></i>
                </div>
                <div class="concept-content">
                    <p class="mb-0">
                        Pinetree draws inspiration from Amazon's "One Pager" culture, which focuses on condensing key points into a single page. People prefer concise, readable content, yet there are times when detailed information is necessary.
                    </p>
                </div>
            </div>

            <div class="concept-box">
                <div class="concept-icon">
                    <i class="bi bi-diagram-3"></i>
                </div>
                <div class="concept-content">
                    <p class="mb-0">
                        As documents grow more detailed, we typically organize them with rules and folders. However, traditional file structures lack physical connections between these documents. Pinetree allows you to express content in a "hierarchical" format and navigate via links, enabling readers to naturally understand the relationships between content.
                    </p>
                </div>
            </div>

            <div class="concept-box">
                <div class="concept-icon">
                    <i class="bi bi-layout-text-window"></i>
                </div>
                <div class="concept-content">
                    <p class="mb-0">
                        Pinetree is ideal for travel plans, resumes, reading notes, and any document requiring both "conciseness" and "detail." You can keep each piece of content as simple as possible while adding hierarchical details as needed. Experience this new writing style for yourself.
                    </p>
                </div>
            </div>
            <blockquote class="mt-4 text-center">
                <p class="fst-italic">Create multiple documents when you <a href="Account/Register" class="alert-link">register</a> for an account.</p>
            </blockquote>
        </div>        <!-- Video section -->
        <div class="video-container my-5 pt-4">
            <h2>Pinetree Overview & Demo</h2>
            <div class="video-wrapper">
                <iframe width="520"
                        src="https://www.youtube.com/embed/afYPumK4trY"
                        title="Pinetree Overview and Demo"
                        frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen>
                </iframe>
            </div>              
            <p class="video-description">
                This 9-minute video covers Pinetree's core concepts and includes a live demonstration of key features. We've implemented the main functionality we envisioned and are now releasing it as a beta version to gather valuable feedback from users.
            </p>
            <div class="alert alert-info mt-3">
                <div class="d-flex align-items-start">
                    <i class="bi bi-info-circle-fill me-2 mt-1"></i>
                    <div>
                        <strong>Beta Version Notice:</strong> Pinetree is currently in beta development. 
                        Please note that this is our first video production, so the quality may not be optimal. 
                        The presentation materials are in English with subtitles, but the narration is in Japanese. 
                        We appreciate your understanding as we continue to improve our content and service.
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Call to action - Full width with distinct background -->
<div class="cta-container">
    <div class="cta-section">
        <h2>Ready to get started?</h2>
        <p>Join our community of organized writers and thinkers today!</p>
        <div class="mt-4">
            <a class="btn btn-primary btn-lg m-2" href="/play"><i class="bi bi-tools"></i>Playground</a>
            <a class="btn btn-success btn-lg m-2" href="Account/Register"><i class="bi bi-person"></i>Register</a>
            <a class="btn btn-info btn-lg m-2" href="/Pricing"><i class="bi bi-tag"></i>Pricing</a>
        </div>

        <div class="mt-4">
            <p class="text-muted">
                We're currently in a phase where we want as many users as possible to try our service. <br>
                Please start with <a href="/play">Playground</a> and we'd appreciate your <a href="/Feedback">feedback</a> afterwards. <br>
                Users who provide valuable feedback will receive a permanent free pass! <br>
            </p>
        </div>
    </div>
</div>

@code {
    [Inject]
    public required NavigationManager NavigationManager { get; set; }

    [Inject]
    public required AuthenticationStateProvider AuthenticationStateProvider { get; set; }

    public const string Url = "https://pine-tree.site";
    public const string Title = "Pinetree(Beta)";
    public const string Description = "Pinetree is a browser-based hierarchical markdown editor.Inspired by Amazon's One-Pager culture, Pinetree helps you create concise documents that everyone actually wants to read. While a one-page summary is ideal, sometimes details matter too.";

    private IJSObjectReference? _jsModule;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            try
            {
                _jsModule = await JSRuntime.InvokeAsync<IJSObjectReference>("import", "./Pages/Home.razor.js");
                await _jsModule.InvokeVoidAsync("initializeSlider");
            }
            catch (Exception ex)
            {
                Console.Error.WriteLine($"Error initializing slider: {ex.Message}");
            }
        }
    }

    private async Task NextSlide()
    {
        if (_jsModule != null)
        {
            await _jsModule.InvokeVoidAsync("nextSlide");
        }
    }

    private async Task PrevSlide()
    {
        if (_jsModule != null)
        {
            await _jsModule.InvokeVoidAsync("prevSlide");
        }
    }

    private async Task SetSlide(int index)
    {
        if (_jsModule != null)
        {
            await _jsModule.InvokeVoidAsync("setSlide", index);
        }
    }

    public async ValueTask DisposeAsync()
    {
        try
        {
            if (_jsModule != null)
            {
                await _jsModule.InvokeVoidAsync("cleanupSlider");
                await _jsModule.DisposeAsync();
            }
        }
        catch (Exception ex)
        {
            Console.Error.WriteLine($"Error disposing slider: {ex.Message}");
        }
    }
}